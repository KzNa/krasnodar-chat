{"version":3,"sources":["meteor://ðŸ’»app/server/methods/canAccessRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,iBAAe,SAAC,GAAD,EAAM,MAAN;AACd;AAAA,WAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,MAApC,EAA4C;AAAA,cAAQ;AAAA,kBAAU,CAAV;OAAR;KAA5C,CAAP;AAEA,yBAAO,IAAI,CAAE,kBAAb;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,iBAAb,EAAgC,iEAAhC,CAAV,CADD;KAFA;AAKA;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,EAA6B,qDAA7B,CAAV,CADD;KALA;AAAA,IAQA,OAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,GAApC,EAAyC;AAAA,MAAE,QAAQ;AAAA,QAAE,WAAW,CAAb;AAAA,QAAgB,GAAG,CAAnB;AAAA,QAAsB,MAAM,CAA5B;AAAA,QAA+B,OAAO,CAAtC;OAAV;KAAzC,CARP;AAUA,QAAG,IAAH;AACC,UAAG,IAAI,CAAC,SAAS,CAAC,OAAf,CAAuB,IAAI,CAAC,QAA5B,MAA2C,EAA9C;AACC,oBAAY,IAAZ,CADD;OAAA,MAEK,IAAG,IAAI,CAAC,CAAL,KAAU,GAAb;AACJ,oBAAY,UAAU,CAAC,KAAK,CAAC,aAAjB,CAA+B,MAA/B,EAAuC,aAAvC,CAAZ,CADI;OAFL;AAKA,UAAG,cAAe,IAAlB;AACC,eAAO,KAAP,CADD;OAAA;AAGC,eAAO,CAAC,CAAC,IAAF,CAAO,IAAP,EAAa,CAAC,KAAD,EAAQ,GAAR,EAAa,MAAb,EAAqB,WAArB,EAAkC,OAAlC,CAAb,CAAP,CAHD;OAND;KAAA;AAWC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,EAA6B,+CAA7B,CAAV,CAXD;KAXc;EAAA,CAAf;CADD","file":"/server/methods/canAccessRoom.coffee.js","sourcesContent":["Meteor.methods\n\tcanAccessRoom: (rid, userId) ->\n\t\tuser = RocketChat.models.Users.findOneById userId, fields: username: 1\n\n\t\tunless user?.username\n\t\t\tthrow new Meteor.Error 'not-logged-user', \"[methods] canAccessRoom -> User doesn't have enough permissions\"\n\n\t\tunless rid\n\t\t\tthrow new Meteor.Error 'invalid-room', '[methods] canAccessRoom -> Cannot access empty room'\n\n\t\troom = RocketChat.models.Rooms.findOneById rid, { fields: { usernames: 1, t: 1, name: 1, muted: 1 } }\n\n\t\tif room\n\t\t\tif room.usernames.indexOf(user.username) isnt -1\n\t\t\t\tcanAccess = true\n\t\t\telse if room.t is 'c'\n\t\t\t\tcanAccess = RocketChat.authz.hasPermission(userId, 'view-c-room')\n\n\t\t\tif canAccess isnt true\n\t\t\t\treturn false\n\t\t\telse\n\t\t\t\treturn _.pick room, ['_id', 't', 'name', 'usernames', 'muted']\n\t\telse\n\t\t\tthrow new Meteor.Error 'invalid-room', '[methods] canAccessRoom -> Room ID is invalid'\n"]}