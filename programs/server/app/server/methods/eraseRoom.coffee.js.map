{"version":3,"sources":["meteor://üíªapp/server/methods/eraseRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,aAAW,SAAC,GAAD;AACV;AAAA,aAAS,MAAM,CAAC,MAAP,EAAT;AAAA,IAEA,yEAAmD,CAAE,UAFrD;AAIA,QAAG,UAAU,CAAC,KAAK,CAAC,aAAjB,CAAgC,MAAhC,EAAwC,YAAU,QAAlD,EAA8D,GAA9D,CAAH;AAGC,gBAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,cAA3B,CAA0C,GAA1C;AAAA,MACA,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAhC,CAA+C,GAA/C,CADA;aAEA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,UAAxB,CAAmC,GAAnC,EALD;KAAA;AAQC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,CAAV,CARD;KALU;EAAA,CAAX;CADD","file":"/server/methods/eraseRoom.coffee.js","sourcesContent":["Meteor.methods\n\teraseRoom: (rid) ->\n\t\tfromId = Meteor.userId()\n\n\t\troomType = RocketChat.models.Rooms.findOneById(rid)?.t\n\n\t\tif RocketChat.authz.hasPermission( fromId, \"delete-#{roomType}\", rid )\n\t\t\t# ChatRoom.update({ _id: rid}, {'$pull': { userWatching: Meteor.userId(), userIn: Meteor.userId() }})\n\n\t\t\tRocketChat.models.Messages.removeByRoomId rid\n\t\t\tRocketChat.models.Subscriptions.removeByRoomId rid\n\t\t\tRocketChat.models.Rooms.removeById rid\n\t\t\t# @TODO remove das mensagens lidas do usu√°rio\n\t\telse\n\t\t\tthrow new Meteor.Error 'unauthorized'\n"]}