{"version":3,"sources":["meteor://ðŸ’»app/server/methods/muteUserInRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,kBAAgB,SAAC,IAAD;AACf;AAAA,aAAS,MAAM,CAAC,MAAP,EAAT;AAAA,IACA,MAAM,IAAN,EAAY,KAAK,CAAC,eAAN,CAAsB;AAAA,MAAE,KAAK,MAAP;AAAA,MAAe,UAAU,MAAzB;KAAtB,CAAZ,CADA;AAGA,mBAAiB,CAAC,KAAK,CAAC,aAAjB,CAA+B,MAA/B,EAAuC,WAAvC,EAAoD,IAAI,CAAC,GAAzD,CAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,aAAb,EAA4B,yCAA5B,CAAV,CADD;KAHA;AAAA,IAMA,OAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,IAAI,CAAC,GAAzC,CANP;AAOA,QAAG,KAAH;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,EAA6B,gDAA7B,CAAV,CADD;KAPA;AAUA,eAAG,IAAI,CAAC,EAAL,KAAe,GAAf,YAAoB,GAAvB;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,mBAAb,EAAkC,+CAAlC,CAAV,CADD;KAVA;AAaA,eAAG,IAAI,CAAC,QAAL,+BAAsB,IAAI,CAAE,mBAAN,IAAmB,EAAzC,WAAH;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,aAAb,EAA4B,sDAA5B,CAAV,CADD;KAbA;AAAA,IAgBA,YAAY,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAxB,CAA0C,IAAI,CAAC,QAA/C,CAhBZ;AAAA,IAkBA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,oBAAxB,CAA6C,IAAI,CAAC,GAAlD,EAAuD,SAAS,CAAC,QAAjE,CAlBA;AAAA,IAoBA,WAAW,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,MAApC,CApBX;AAAA,IAqBA,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,gCAA3B,CAA4D,IAAI,CAAC,GAAjE,EAAsE,SAAtE,EACC;AAAA,SACC;AAAA,aAAK,QAAQ,CAAC,GAAd;AAAA,QACA,UAAU,QAAQ,CAAC,QADnB;OADD;KADD,CArBA;AA0BA,WAAO,IAAP,CA3Be;EAAA,CAAhB;CADD","file":"/server/methods/muteUserInRoom.coffee.js","sourcesContent":["Meteor.methods\n\tmuteUserInRoom: (data) ->\n\t\tfromId = Meteor.userId()\n\t\tcheck(data, Match.ObjectIncluding({ rid: String, username: String }))\n\n\t\tunless RocketChat.authz.hasPermission(fromId, 'mute-user', data.rid)\n\t\t\tthrow new Meteor.Error 'not-allowed', '[methods] muteUserInRoom -> Not allowed'\n\n\t\troom = RocketChat.models.Rooms.findOneById data.rid\n\t\tif not room\n\t\t\tthrow new Meteor.Error 'invalid-room', '[methods] muteUserInRoom -> Room ID is invalid'\n\n\t\tif room.t not in ['c', 'p']\n\t\t\tthrow new Meteor.Error 'invalid-room-type', '[methods] muteUserInRoom -> Invalid room type'\n\n\t\tif data.username not in (room?.usernames or [])\n\t\t\tthrow new Meteor.Error 'not-in-room', '[methods] muteUserInRoom -> User is not in this room'\n\n\t\tmutedUser = RocketChat.models.Users.findOneByUsername data.username\n\n\t\tRocketChat.models.Rooms.muteUsernameByRoomId data.rid, mutedUser.username\n\n\t\tfromUser = RocketChat.models.Users.findOneById fromId\n\t\tRocketChat.models.Messages.createUserMutedWithRoomIdAndUser data.rid, mutedUser,\n\t\t\tu:\n\t\t\t\t_id: fromUser._id\n\t\t\t\tusername: fromUser.username\n\n\t\treturn true\n"]}