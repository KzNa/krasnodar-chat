{"version":3,"sources":["meteor://ðŸ’»app/server/methods/saveUserProfile.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,mBAAiB,SAAC,QAAD;AAChB;AAAA,iBAAe,CAAC,eAAhB;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,0BAAb,EAAyC,uDAAzC,CAAV,CADD;KAAA;AAGA,mBAAiB,CAAC,QAAQ,CAAC,GAApB,CAAwB,iCAAxB,CAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,GAAb,EAAkB,6CAAlB,CAAV,CADD;KAHA;AAMA,QAAG,MAAM,CAAC,MAAP,EAAH;AACC,aAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,MAAM,CAAC,MAAP,EAApC,CAAP;AAAA,MAEA,YAAY,QAAQ,CAAC,cAAT,CAAwB,IAAxB,EAA8B;AAAA,QAAE,QAAQ,QAAQ,CAAC,eAAnB;AAAA,QAAoC,WAAW,SAA/C;OAA9B,CAFZ;AAGA,UAAG,SAAS,CAAC,KAAb;AACC,cAAU,UAAM,CAAC,KAAP,CAAa,kBAAb,EAAiC,+CAAjC,CAAV,CADD;OAHA;AAMA,UAAG,4BAAH;AACC,gBAAQ,CAAC,WAAT,CAAqB,MAAM,CAAC,MAAP,EAArB,EAAsC,QAAQ,CAAC,WAA/C,EAA4D;AAAA,UAAE,QAAQ,KAAV;SAA5D,EADD;OANA;AASA,UAAG,yBAAH;AACC,cAAM,CAAC,IAAP,CAAY,aAAZ,EAA2B,QAAQ,CAAC,QAApC,EADD;OATA;AAYA,UAAG,yBAAH;AACC,cAAM,CAAC,IAAP,CAAY,aAAZ,EAA2B,QAAQ,CAAC,QAApC,EADD;OAZA;AAeA,UAAG,sBAAH;AACC,cAAM,CAAC,IAAP,CAAY,UAAZ,EAAwB,QAAQ,CAAC,KAAjC,EADD;OAfA;AAAA,MAkBA,UAAU,EAlBV;AAAA,MAoBA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,UAAxB,CAAmC,MAAM,CAAC,MAAP,EAAnC,EAAoD,OAApD,CApBA;AAsBA,aAAO,IAAP,CAvBD;KAPgB;EAAA,CAAjB;CADD","file":"/server/methods/saveUserProfile.coffee.js","sourcesContent":["Meteor.methods\n\tsaveUserProfile: (settings) ->\n\t\tunless settings.currentPassword\n\t\t\tthrow new Meteor.Error('missing-current-password', \"[methods] saveUserProfile -> Missing current password\")\n\n\t\tunless RocketChat.settings.get(\"Accounts_AllowUserProfileChange\")\n\t\t\tthrow new Meteor.Error(403, \"[methods] saveUserProfile -> Invalid access\")\n\n\t\tif Meteor.userId()\n\t\t\tuser = RocketChat.models.Users.findOneById(Meteor.userId());\n\n\t\t\tpassCheck = Accounts._checkPassword(user, { digest: settings.currentPassword, algorithm: 'sha-256' });\n\t\t\tif passCheck.error\n\t\t\t\tthrow new Meteor.Error('invalid-password', \"[methods] saveUserProfile -> Invalid password\");\n\n\t\t\tif settings.newPassword?\n\t\t\t\tAccounts.setPassword Meteor.userId(), settings.newPassword, { logout: false }\n\n\t\t\tif settings.realname?\n\t\t\t\tMeteor.call 'setRealName', settings.realname\n\n\t\t\tif settings.username?\n\t\t\t\tMeteor.call 'setUsername', settings.username\n\n\t\t\tif settings.email?\n\t\t\t\tMeteor.call 'setEmail', settings.email\n\n\t\t\tprofile = {}\n\n\t\t\tRocketChat.models.Users.setProfile Meteor.userId(), profile\n\n\t\t\treturn true\n"]}