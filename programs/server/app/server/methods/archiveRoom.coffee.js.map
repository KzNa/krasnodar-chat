{"version":3,"sources":["meteor://ðŸ’»app/server/methods/archiveRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,eAAa,SAAC,GAAD;AACZ;AAAA,QAAG,OAAU,CAAC,MAAP,EAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,EAA6B,uCAA7B,CAAV,CADD;KAAA;AAAA,IAGA,OAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,GAApC,CAHP;AAKA;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,cAAb,EAA6B,yCAA7B,CAAV,CADD;KALA;AAQA,QAAG,oBAAY,IAAI,CAAC,CAAC,CAAC,GAAP,KAAc,MAAM,CAAC,MAAP,EAA1B,IAA6C,UAAU,CAAC,KAAK,CAAC,OAAjB,CAAyB,MAAM,CAAC,MAAP,EAAzB,EAA0C,OAA1C,CAAhD;AACC,gBAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,GAApC;AAEA;AAAA;WAAA;0BAAA;AACC,iBAAS,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAxB,CAA0C,QAA1C,EAAoD;AAAA,UAAE,QAAQ;AAAA,YAAE,UAAU,CAAZ;WAAV;SAApD,CAAT;AACA,YAAO,cAAP;AACC,mBADD;SADA;AAAA,qBAIA,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,wBAAhC,CAAyD,GAAzD,EAA8D,MAAM,CAAC,GAArE,EAJA,CADD;AAAA;qBAHD;KATY;EAAA,CAAb;CADD","file":"/server/methods/archiveRoom.coffee.js","sourcesContent":["Meteor.methods\n\tarchiveRoom: (rid) ->\n\t\tif not Meteor.userId()\n\t\t\tthrow new Meteor.Error 'invalid-user', '[methods] archiveRoom -> Invalid user'\n\n\t\troom = RocketChat.models.Rooms.findOneById rid\n\n\t\tunless room\n\t\t\tthrow new Meteor.Error 'invalid-room', '[methods] unarchiveRoom -> Invalid room'\n\n\t\tif room.u? and room.u._id is Meteor.userId() or RocketChat.authz.hasRole(Meteor.userId(), 'admin')\n\t\t\tRocketChat.models.Rooms.archiveById rid\n\n\t\t\tfor username in room.usernames\n\t\t\t\tmember = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1 }})\n\t\t\t\tif not member?\n\t\t\t\t\tcontinue\n\n\t\t\t\tRocketChat.models.Subscriptions.archiveByRoomIdAndUserId rid, member._id\n"]}